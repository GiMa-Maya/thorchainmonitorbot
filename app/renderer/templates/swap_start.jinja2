{% extends "base.jinja2" %}

{% block content %}

    {% include "_tx_helpers.jinja2" %}

    <style>
        .line-box {
            display: flex;
        }

        .route-box {
            position: absolute;
            left: 12%;
            right: 12%;
            top: 24%;
            height: 30%;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        .logo-holder {
            display: flex;
            flex-direction: column;
        }

        .tc-glow {
            filter: drop-shadow(6px 6px 12px rgba(0, 213, 213, 0.51)) drop-shadow(-6px -6px 12px rgba(3, 243, 150, 0.51));
        }

        .circle-tc-logo {
            width: 200px;
            padding: 13px;
        }

        .arrow-lr, .arrow-pending {
            width: 180px;
            filter: brightness(190%) hue-rotate(30deg) saturate(200%) drop-shadow(3px 3px 4px rgba(0, 213, 213, 0.51)) drop-shadow(-3px -3px 4px rgba(3, 243, 150, 0.51));
        }

        .arrow-pending {
            filter: brightness(45%) hue-rotate(60deg) saturate(160%);
            opacity: 0.9;
        }

        .white-shadow {
            filter: drop-shadow(0px 0px 10px rgba(255, 255, 255, 0.3));
        }

        .logo-part {
            display: flex;
            justify-content: center;
            align-content: center;
        }

        .from {
            font-style: normal;
            font-weight: normal;
        }

        .input-amount, .output-amount {
            text-shadow: 0 0 10px rgba(69, 221, 237, 60%);
        }

        .asset-part {
            display: flex;
            flex-direction: column;
            margin-top: 34px;

            font-family: ThorFontLight, serif;
            font-weight: bold;
            font-size: 45px;

            position: absolute;
            top: 80%;
            width: 42%;

            text-align: center;
        }

        .arrow-down-holder {
            position: absolute;
            margin-top: 22%;
            transform: translate(-50px, 0);
            width: 300px;
            text-align: center;
        }

        .arrow-down {
            width: 30px;
            margin-bottom: 10px;
        }

        .arrow-aff {
            filter: brightness(200%);
            opacity: 90%;
        }

        .arrow-no-aff {
            filter: brightness(2000%);
            opacity: 0.4;
        }

        .above-arrow {
            position: absolute;
            bottom: 150px;
            width: 180px;
            text-align: center;
        }

        .tx-id-block {
            font-size: 30px;
            font-style: italic;
            margin-bottom: 4px;
            color: #23DCC8;
        }

        .time-block-flex {
            display: inline-flex;
            align-items: center;
            flex-direction: row;
            justify-content: center;
        }

        .time-block-interval {
            padding-right: 22px;
            display: block;
            color: #23DCC8;
            text-align: center;
            font-size: 27px;
            width: 200px;
        }

        .clock {
            width: 60px;
            display: inline-flex;
            filter: brightness(80%);
            padding: 8px;
        }

        .wait-time {
            padding-left: 5px;
            margin-bottom: 5px;
            display: flex;
            color: #45dded;
            opacity: 0.8;
            font-weight: 400;
            font-size: 30px;
        }

        .usd-volume {
            color: #c5c5c5;
            font-weight: 400;
        }

        .expected-out-label {
            color: #c5c5c5;
            font-weight: normal;
            font-size: 30px;
            margin-top: 7px;
            margin-bottom: 10px;
        }

    </style>

    <div class="header-box">
        <img class="logo" src="renderer/static/tc_logo_transparent.png?rv=1" alt="THORChain logo">
        <div class="title">THORCHAIN â¤¬ STREAMING SWAP STARTED</div>
    </div>


    <div class="route-box">

        <div id="source_logo" class="logo-holder">
            <div class="logo-part">
                <img src="renderer/logo/{{ source_asset }}.png" alt="Source asset logo"
                     class="asset-logo white-shadow">
                <div class="asset-part">
                    <div class="from">
                        {{ "ðŸ¤–" if "Arb-Bot" in user_name else "ðŸ‘¤" }}
                        {{ user_name }}
                    </div>
                    <div class="input-amount">
                        {{ short_money(source_amount) }} {{ source_asset_name }}
                    </div>
                    <div class="usd-volume">
                        ({{ short_dollar(volume_usd) }})
                    </div>
                </div>
            </div>

        </div>

        <div class="line-box">
            <img src="renderer/static/arrow2.png" alt="Arrow right" class="arrow-lr shadow">
            <div class="above-arrow tx-id-block">
                {{ shorten_text_middle(tx_hash, 4, 4) }}
            </div>
        </div>

        <div class="logo-holder">
            <img class="circle-tc-logo tc-glow" src="renderer/static/tc_logo_circle.png?rv=1" alt="THORChain logo">

            <div class="arrow-down-holder">
                <div>
                    {% if affiliate_fee > 0 %}
                        <img src="renderer/static/arrow2-down.png" alt="Arrow down" class="shadow arrow-down arrow-aff">
                    {% else %}
                        <img src="renderer/static/arrow2-down.png" alt="Arrow down"
                             class="shadow arrow-down arrow-no-aff">
                    {% endif %}
                </div>

                {% include "components/aff-logo.jinja2" %}

            </div>

        </div>

        <div class="line-box">
            <img src="renderer/static/arrow2.png" alt="Arrow right" class="arrow-pending shadow">
            <div class="above-arrow">
                <div class="time-block-interval">
                    <strong>{{ int(swap_quantity) }}</strong>
                    <span>{{ "swaps" if swap_quantity >= 2 else "swap" }} every</span>
                    <strong>{{ int(swap_interval) }}</strong>
                    <span>{{ "blocks" if swap_interval >= 2 else "block" }}</span>
                </div>
            </div>
        </div>

        <div id="dest_logo" class="logo-holder">
            <div class="logo-part">
                <img src="renderer/logo/{{ destination_asset }}.png" alt="Destination asset logo"
                     class="asset-logo white-shadow" onerror="console.error('{{ destination_asset }} no logo!')">

                <div class="asset-part">
                    <div class="expected-out-label">Expected output</div>
                    <div class="output-amount">
                        {% if destination_amount %}
                            â‰ˆ{{ short_money(destination_amount) }} {{ destination_asset_name }}
                        {% else %}
                            â‰ˆ N/A {{ destination_asset_name }}
                        {% endif %}
                    </div>

                        <div class="time-block-flex">
                            <img src="renderer/static/time-is-money.png" alt="Time is money..." class="clock">
                            <div class="wait-time" id="wait-time"></div>
                        </div>

                </div>

            </div>
        </div>

    </div>

    <script>
        const waitTimeSec = {{ total_estimated_time_sec }};
        let result = '??:??';
        if (waitTimeSec !== 0) {
            // format HH:MM:SS or MM:SS if less than 1 hour
            const formatTime = (time) => {
                const pad = (num) => String(num).padStart(2, '0');
                const hours = Math.floor(time / 3600);
                const minutes = Math.floor((time % 3600) / 60);
                const seconds = time % 60;
                return hours > 0 ? `${pad(hours)}:${pad(minutes)}:${pad(seconds)}` : `${pad(minutes)}:${pad(seconds)}`;
            };
            result = formatTime(waitTimeSec);
        }
        document.querySelector('#wait-time').textContent = result;
    </script>

{% endblock %}
